"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/realtime/emit/route";
exports.ids = ["app/api/realtime/emit/route"];
exports.modules = {

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Frealtime%2Femit%2Froute&page=%2Fapi%2Frealtime%2Femit%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Frealtime%2Femit%2Froute.ts&appDir=C%3A%5Cpepite-mail-proto%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5Cpepite-mail-proto&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!*******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Frealtime%2Femit%2Froute&page=%2Fapi%2Frealtime%2Femit%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Frealtime%2Femit%2Froute.ts&appDir=C%3A%5Cpepite-mail-proto%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5Cpepite-mail-proto&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \*******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var C_pepite_mail_proto_src_app_api_realtime_emit_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./src/app/api/realtime/emit/route.ts */ \"(rsc)/./src/app/api/realtime/emit/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/realtime/emit/route\",\n        pathname: \"/api/realtime/emit\",\n        filename: \"route\",\n        bundlePath: \"app/api/realtime/emit/route\"\n    },\n    resolvedPagePath: \"C:\\\\pepite-mail-proto\\\\src\\\\app\\\\api\\\\realtime\\\\emit\\\\route.ts\",\n    nextConfigOutput,\n    userland: C_pepite_mail_proto_src_app_api_realtime_emit_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/realtime/emit/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZyZWFsdGltZSUyRmVtaXQlMkZyb3V0ZSZwYWdlPSUyRmFwaSUyRnJlYWx0aW1lJTJGZW1pdCUyRnJvdXRlJmFwcFBhdGhzPSZwYWdlUGF0aD1wcml2YXRlLW5leHQtYXBwLWRpciUyRmFwaSUyRnJlYWx0aW1lJTJGZW1pdCUyRnJvdXRlLnRzJmFwcERpcj1DJTNBJTVDcGVwaXRlLW1haWwtcHJvdG8lNUNzcmMlNUNhcHAmcGFnZUV4dGVuc2lvbnM9dHN4JnBhZ2VFeHRlbnNpb25zPXRzJnBhZ2VFeHRlbnNpb25zPWpzeCZwYWdlRXh0ZW5zaW9ucz1qcyZyb290RGlyPUMlM0ElNUNwZXBpdGUtbWFpbC1wcm90byZpc0Rldj10cnVlJnRzY29uZmlnUGF0aD10c2NvbmZpZy5qc29uJmJhc2VQYXRoPSZhc3NldFByZWZpeD0mbmV4dENvbmZpZ091dHB1dD0mcHJlZmVycmVkUmVnaW9uPSZtaWRkbGV3YXJlQ29uZmlnPWUzMCUzRCEiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7O0FBQXNHO0FBQ3ZDO0FBQ2M7QUFDYztBQUMzRjtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsZ0hBQW1CO0FBQzNDO0FBQ0EsY0FBYyx5RUFBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsWUFBWTtBQUNaLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQSxRQUFRLGlFQUFpRTtBQUN6RTtBQUNBO0FBQ0EsV0FBVyw0RUFBVztBQUN0QjtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ3VIOztBQUV2SCIsInNvdXJjZXMiOlsid2VicGFjazovL3BlcGl0ZS1tYWlsLXByb3RvLz81OWYzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEFwcFJvdXRlUm91dGVNb2R1bGUgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUtbW9kdWxlcy9hcHAtcm91dGUvbW9kdWxlLmNvbXBpbGVkXCI7XG5pbXBvcnQgeyBSb3V0ZUtpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUta2luZFwiO1xuaW1wb3J0IHsgcGF0Y2hGZXRjaCBhcyBfcGF0Y2hGZXRjaCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2xpYi9wYXRjaC1mZXRjaFwiO1xuaW1wb3J0ICogYXMgdXNlcmxhbmQgZnJvbSBcIkM6XFxcXHBlcGl0ZS1tYWlsLXByb3RvXFxcXHNyY1xcXFxhcHBcXFxcYXBpXFxcXHJlYWx0aW1lXFxcXGVtaXRcXFxccm91dGUudHNcIjtcbi8vIFdlIGluamVjdCB0aGUgbmV4dENvbmZpZ091dHB1dCBoZXJlIHNvIHRoYXQgd2UgY2FuIHVzZSB0aGVtIGluIHRoZSByb3V0ZVxuLy8gbW9kdWxlLlxuY29uc3QgbmV4dENvbmZpZ091dHB1dCA9IFwiXCJcbmNvbnN0IHJvdXRlTW9kdWxlID0gbmV3IEFwcFJvdXRlUm91dGVNb2R1bGUoe1xuICAgIGRlZmluaXRpb246IHtcbiAgICAgICAga2luZDogUm91dGVLaW5kLkFQUF9ST1VURSxcbiAgICAgICAgcGFnZTogXCIvYXBpL3JlYWx0aW1lL2VtaXQvcm91dGVcIixcbiAgICAgICAgcGF0aG5hbWU6IFwiL2FwaS9yZWFsdGltZS9lbWl0XCIsXG4gICAgICAgIGZpbGVuYW1lOiBcInJvdXRlXCIsXG4gICAgICAgIGJ1bmRsZVBhdGg6IFwiYXBwL2FwaS9yZWFsdGltZS9lbWl0L3JvdXRlXCJcbiAgICB9LFxuICAgIHJlc29sdmVkUGFnZVBhdGg6IFwiQzpcXFxccGVwaXRlLW1haWwtcHJvdG9cXFxcc3JjXFxcXGFwcFxcXFxhcGlcXFxccmVhbHRpbWVcXFxcZW1pdFxcXFxyb3V0ZS50c1wiLFxuICAgIG5leHRDb25maWdPdXRwdXQsXG4gICAgdXNlcmxhbmRcbn0pO1xuLy8gUHVsbCBvdXQgdGhlIGV4cG9ydHMgdGhhdCB3ZSBuZWVkIHRvIGV4cG9zZSBmcm9tIHRoZSBtb2R1bGUuIFRoaXMgc2hvdWxkXG4vLyBiZSBlbGltaW5hdGVkIHdoZW4gd2UndmUgbW92ZWQgdGhlIG90aGVyIHJvdXRlcyB0byB0aGUgbmV3IGZvcm1hdC4gVGhlc2Vcbi8vIGFyZSB1c2VkIHRvIGhvb2sgaW50byB0aGUgcm91dGUuXG5jb25zdCB7IHJlcXVlc3RBc3luY1N0b3JhZ2UsIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzIH0gPSByb3V0ZU1vZHVsZTtcbmNvbnN0IG9yaWdpbmFsUGF0aG5hbWUgPSBcIi9hcGkvcmVhbHRpbWUvZW1pdC9yb3V0ZVwiO1xuZnVuY3Rpb24gcGF0Y2hGZXRjaCgpIHtcbiAgICByZXR1cm4gX3BhdGNoRmV0Y2goe1xuICAgICAgICBzZXJ2ZXJIb29rcyxcbiAgICAgICAgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZVxuICAgIH0pO1xufVxuZXhwb3J0IHsgcm91dGVNb2R1bGUsIHJlcXVlc3RBc3luY1N0b3JhZ2UsIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzLCBvcmlnaW5hbFBhdGhuYW1lLCBwYXRjaEZldGNoLCAgfTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YXBwLXJvdXRlLmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Frealtime%2Femit%2Froute&page=%2Fapi%2Frealtime%2Femit%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Frealtime%2Femit%2Froute.ts&appDir=C%3A%5Cpepite-mail-proto%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5Cpepite-mail-proto&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./src/app/api/realtime/emit/route.ts":
/*!********************************************!*\
  !*** ./src/app/api/realtime/emit/route.ts ***!
  \********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   POST: () => (/* binding */ POST),\n/* harmony export */   runtime: () => (/* binding */ runtime)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var _lib_realtime_hub__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../../lib/realtime/hub */ \"(rsc)/./src/lib/realtime/hub.ts\");\n/* harmony import */ var _lib_audit_store__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../../lib/audit/store */ \"(rsc)/./src/lib/audit/store.ts\");\n/* harmony import */ var _lib_realtime_chatStore__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../../lib/realtime/chatStore */ \"(rsc)/./src/lib/realtime/chatStore.ts\");\n\n\n\n\nconst roleMatrix = {\n    chef: [\n        \"send_chat\",\n        \"update_cursor\",\n        \"assign_role\",\n        \"view_audit\",\n        \"manage_project\"\n    ],\n    manager: [\n        \"send_chat\",\n        \"update_cursor\",\n        \"assign_role\",\n        \"view_audit\"\n    ],\n    assistant: [\n        \"send_chat\",\n        \"update_cursor\",\n        \"view_audit\"\n    ],\n    employe: [\n        \"send_chat\",\n        \"update_cursor\"\n    ]\n};\nfunction can(role, action) {\n    return roleMatrix[role]?.includes(action) ?? false;\n}\nfunction actionFromEvent(event) {\n    switch(event){\n        case \"chat\":\n            return \"send_chat\";\n        case \"dm\":\n            return \"send_chat\"; // DM = chat privé\n        case \"cursor\":\n            return \"update_cursor\";\n        case \"assign_role\":\n            return \"assign_role\";\n        case \"audit:view\":\n            return \"view_audit\";\n        case \"project:manage\":\n            return \"manage_project\";\n        default:\n            return null;\n    }\n}\nconst runtime = \"nodejs\";\nasync function POST(req) {\n    try {\n        const body = await req.json();\n        const { room = \"default\", event, payload = {}, user } = body || {};\n        if (!event || !user?.id || !user?.name || !user?.role) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"Missing event or user\"\n            }, {\n                status: 400\n            });\n        }\n        const action = actionFromEvent(event);\n        if (action && !can(user.role, action)) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"Forbidden\"\n            }, {\n                status: 403\n            });\n        }\n        const now = Date.now();\n        // Chat public (room)\n        if (event === \"chat\") {\n            const id = String(payload?.id || `${now}-${Math.random().toString(36).slice(2, 8)}`);\n            const text = String(payload?.text || \"\").slice(0, 2000);\n            (0,_lib_realtime_chatStore__WEBPACK_IMPORTED_MODULE_3__.addChatMessage)(room, {\n                id,\n                room,\n                user,\n                text,\n                ts: now\n            });\n            _lib_realtime_hub__WEBPACK_IMPORTED_MODULE_1__.hub.broadcast(room, \"chat\", {\n                user,\n                payload: {\n                    id,\n                    text\n                },\n                ts: now\n            });\n            (0,_lib_audit_store__WEBPACK_IMPORTED_MODULE_2__.addAudit)({\n                ts: now,\n                room,\n                event: \"chat\",\n                user,\n                payload: {\n                    id,\n                    text\n                },\n                summary: `${user.name} a envoyé un message: \"${text.slice(0, 60)}\"`\n            });\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                ok: true\n            });\n        }\n        // Chat privé (DM)\n        if (event === \"dm\") {\n            const toUserId = String(payload?.toUserId || \"\");\n            const id = String(payload?.id || `${now}-${Math.random().toString(36).slice(2, 8)}`);\n            const text = String(payload?.text || \"\").slice(0, 2000);\n            if (!toUserId || !text) {\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Missing toUserId or text\"\n                }, {\n                    status: 400\n                });\n            }\n            const dmKey = (0,_lib_realtime_chatStore__WEBPACK_IMPORTED_MODULE_3__.dmRoom)(user.id, toUserId);\n            (0,_lib_realtime_chatStore__WEBPACK_IMPORTED_MODULE_3__.addChatMessage)(dmKey, {\n                id,\n                room: dmKey,\n                user,\n                text,\n                ts: now\n            });\n            // Diffusion dans la room DM (si l’autre a ouvert la même conversation)\n            _lib_realtime_hub__WEBPACK_IMPORTED_MODULE_1__.hub.broadcast(dmKey, \"dm\", {\n                user,\n                payload: {\n                    id,\n                    text,\n                    toUserId\n                },\n                ts: now\n            });\n            // Et diffusion sur le canal personnel du destinataire (pour notification/consommation hors DM ouvert)\n            _lib_realtime_hub__WEBPACK_IMPORTED_MODULE_1__.hub.broadcast(`user:${toUserId}`, \"dm\", {\n                user,\n                payload: {\n                    id,\n                    text,\n                    toUserId\n                },\n                ts: now\n            });\n            (0,_lib_audit_store__WEBPACK_IMPORTED_MODULE_2__.addAudit)({\n                ts: now,\n                room: dmKey,\n                event: \"dm\",\n                user,\n                payload: {\n                    id,\n                    text,\n                    toUserId\n                },\n                summary: `${user.name} a envoyé un message privé à ${toUserId}: \"${text.slice(0, 60)}\"`\n            });\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                ok: true\n            });\n        }\n        // Autres événements\n        const envelope = {\n            user,\n            payload,\n            ts: now\n        };\n        _lib_realtime_hub__WEBPACK_IMPORTED_MODULE_1__.hub.broadcast(room, event, envelope);\n        (0,_lib_audit_store__WEBPACK_IMPORTED_MODULE_2__.addAudit)({\n            ts: envelope.ts,\n            room,\n            event,\n            user,\n            payload: sanitizePayload(event, payload),\n            summary: summarize(event, user, payload)\n        });\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            ok: true\n        });\n    } catch (e) {\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: e?.message || \"server error\"\n        }, {\n            status: 500\n        });\n    }\n}\nfunction sanitizePayload(event, payload) {\n    if (event === \"chat\") {\n        return {\n            id: payload?.id,\n            text: String(payload?.text || \"\").slice(0, 300)\n        };\n    }\n    if (event === \"cursor\") return {\n        x: Number(payload?.x),\n        y: Number(payload?.y)\n    };\n    return payload ?? {};\n}\nfunction summarize(event, user, payload) {\n    if (event === \"chat\") return `${user.name} a envoyé un message: \"${String(payload?.text || \"\").slice(0, 60)}\"`;\n    if (event === \"cursor\") return `${user.name} a bougé son curseur`;\n    return `${user.name} a effectué l'action \"${event}\"`;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvYXBwL2FwaS9yZWFsdGltZS9lbWl0L3JvdXRlLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7OztBQUF3RDtBQUNMO0FBQ0k7QUFDcUI7QUFXNUUsTUFBTUssYUFBcUM7SUFDekNDLE1BQU07UUFBQztRQUFhO1FBQWlCO1FBQWU7UUFBYztLQUFpQjtJQUNuRkMsU0FBUztRQUFDO1FBQWE7UUFBaUI7UUFBZTtLQUFhO0lBQ3BFQyxXQUFXO1FBQUM7UUFBYTtRQUFpQjtLQUFhO0lBQ3ZEQyxTQUFTO1FBQUM7UUFBYTtLQUFnQjtBQUN6QztBQUVBLFNBQVNDLElBQUlDLElBQVUsRUFBRUMsTUFBYztJQUNyQyxPQUFPUCxVQUFVLENBQUNNLEtBQUssRUFBRUUsU0FBU0QsV0FBVztBQUMvQztBQUVBLFNBQVNFLGdCQUFnQkMsS0FBYTtJQUNwQyxPQUFRQTtRQUNOLEtBQUs7WUFBUSxPQUFPO1FBQ3BCLEtBQUs7WUFBTSxPQUFPLGFBQWEsa0JBQWtCO1FBQ2pELEtBQUs7WUFBVSxPQUFPO1FBQ3RCLEtBQUs7WUFBZSxPQUFPO1FBQzNCLEtBQUs7WUFBYyxPQUFPO1FBQzFCLEtBQUs7WUFBa0IsT0FBTztRQUM5QjtZQUFTLE9BQU87SUFDbEI7QUFDRjtBQUVPLE1BQU1DLFVBQVUsU0FBUztBQUV6QixlQUFlQyxLQUFLQyxHQUFnQjtJQUN6QyxJQUFJO1FBQ0YsTUFBTUMsT0FBTyxNQUFNRCxJQUFJRSxJQUFJO1FBQzNCLE1BQU0sRUFBRUMsT0FBTyxTQUFTLEVBQUVOLEtBQUssRUFBRU8sVUFBVSxDQUFDLENBQUMsRUFBRUMsSUFBSSxFQUFFLEdBQUdKLFFBQVEsQ0FBQztRQUNqRSxJQUFJLENBQUNKLFNBQVMsQ0FBQ1EsTUFBTUMsTUFBTSxDQUFDRCxNQUFNRSxRQUFRLENBQUNGLE1BQU1aLE1BQU07WUFDckQsT0FBT1gscURBQVlBLENBQUNvQixJQUFJLENBQUM7Z0JBQUVNLE9BQU87WUFBd0IsR0FBRztnQkFBRUMsUUFBUTtZQUFJO1FBQzdFO1FBRUEs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RyxJQUFJbkIsVUFBVSxVQUFVLE9BQU8sQ0FBQyxFQUFFUSxLQUFLRSxJQUFJLENBQUMsb0JBQW9CLENBQUM7SUFDakUsT0FBTyxDQUFDLEVBQUVGLEtBQUtFLElBQUksQ0FBQyxzQkFBc0IsRUFBRVYsTUFBTSxDQUFDLENBQUM7QUFDdEQiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9wZXBpdGUtbWFpbC1wcm90by8uL3NyYy9hcHAvYXBpL3JlYWx0aW1lL2VtaXQvcm91dGUudHM/N2U2MiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBOZXh0UmVxdWVzdCwgTmV4dFJlc3BvbnNlIH0gZnJvbSBcIm5leHQvc2VydmVyXCI7XHJcbmltcG9ydCB7IGh1YiB9IGZyb20gXCIuLi8uLi8uLi8uLi9saWIvcmVhbHRpbWUvaHViXCI7XHJcbmltcG9ydCB7IGFkZEF1ZGl0IH0gZnJvbSBcIi4uLy4uLy4uLy4uL2xpYi9hdWRpdC9zdG9yZVwiO1xyXG5pbXBvcnQgeyBhZGRDaGF0TWVzc2FnZSwgZG1Sb29tIH0gZnJvbSBcIi4uLy4uLy4uLy4uL2xpYi9yZWFsdGltZS9jaGF0U3RvcmVcIjtcclxuXHJcbi8vIETDqWZpbml0aW9uIGxvY2FsZSBkZXMgcsO0bGVzL3Blcm1pc3Npb25zXHJcbnR5cGUgUm9sZSA9IFwiY2hlZlwiIHwgXCJtYW5hZ2VyXCIgfCBcImFzc2lzdGFudFwiIHwgXCJlbXBsb3llXCI7XHJcbnR5cGUgQWN0aW9uID1cclxuICB8IFwic2VuZF9jaGF0XCJcclxuICB8IFwidXBkYXRlX2N1cnNvclwiXHJcbiAgfCBcImFzc2lnbl9yb2xlXCJcclxuICB8IFwidmlld19hdWRpdFwiXHJcbiAgfCBcIm1hbmFnZV9wcm9qZWN0XCI7XHJcblxyXG5jb25zdCByb2xlTWF0cml4OiBSZWNvcmQ8Um9sZSwgQWN0aW9uW10+ID0ge1xyXG4gIGNoZWY6IFtcInNlbmRfY2hhdFwiLCBcInVwZGF0ZV9jdXJzb3JcIiwgXCJhc3NpZ25fcm9sZVwiLCBcInZpZXdfYXVkaXRcIiwgXCJtYW5hZ2VfcHJvamVjdFwiXSxcclxuICBtYW5hZ2VyOiBbXCJzZW5kX2NoYXRcIiwgXCJ1cGRhdGVfY3Vyc29yXCIsIFwiYXNzaWduX3JvbGVcIiwgXCJ2aWV3X2F1ZGl0XCJdLFxyXG4gIGFzc2lzdGFudDogW1wic2VuZF9jaGF0XCIsIFwidXBkYXRlX2N1cnNvclwiLCBcInZpZXdfYXVkaXRcIl0sXHJcbiAgZW1wbG95ZTogW1wic2VuZF9jaGF0XCIsIFwidXBkYXRlX2N1cnNvclwiXSxcclxufTtcclxuXHJcbmZ1bmN0aW9uIGNhbihyb2xlOiBSb2xlLCBhY3Rpb246IEFjdGlvbikge1xyXG4gIHJldHVybiByb2xlTWF0cml4W3JvbGVdPy5pbmNsdWRlcyhhY3Rpb24pID8/IGZhbHNlO1xyXG59XHJcblxyXG5mdW5jdGlvbiBhY3Rpb25Gcm9tRXZlbnQoZXZlbnQ6IHN0cmluZyk6IEFjdGlvbiB8IG51bGwge1xyXG4gIHN3aXRjaCAoZXZlbnQpIHtcclxuICAgIGNhc2UgXCJjaGF0XCI6IHJldHVybiBcInNlbmRfY2hhdFwiO1xyXG4gICAgY2FzZSBcImRtXCI6IHJldHVybiBcInNlbmRfY2hhdFwiOyAvLyBETSA9IGNoYXQgcHJpdsOpXHJcbiAgICBjYXNlIFwiY3Vyc29yXCI6IHJldHVybiBcInVwZGF0ZV9jdXJzb3JcIjtcclxuICAgIGNhc2UgXCJhc3NpZ25fcm9sZVwiOiByZXR1cm4gXCJhc3NpZ25fcm9sZVwiO1xyXG4gICAgY2FzZSBcImF1ZGl0OnZpZXdcIjogcmV0dXJuIFwidmlld19hdWRpdFwiO1xyXG4gICAgY2FzZSBcInByb2plY3Q6bWFuYWdlXCI6IHJldHVybiBcIm1hbmFnZV9wcm9qZWN0XCI7XHJcbiAgICBkZWZhdWx0OiByZXR1cm4gbnVsbDtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBjb25zdCBydW50aW1lID0gXCJub2RlanNcIjtcclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBQT1NUKHJlcTogTmV4dFJlcXVlc3QpIHtcclxuICB0cnkge1xyXG4gICAgY29uc3QgYm9keSA9IGF3YWl0IHJlcS5qc29uKCk7XHJcbiAgICBjb25zdCB7IHJvb20gPSBcImRlZmF1bHRcIiwgZXZlbnQsIHBheWxvYWQgPSB7fSwgdXNlciB9ID0gYm9keSB8fCB7fTtcclxuICAgIGlmICghZXZlbnQgfHwgIXVzZXI/LmlkIHx8ICF1c2VyPy5uYW1lIHx8ICF1c2VyPy5yb2xlKSB7XHJcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiBcIk1pc3NpbmcgZXZlbnQgb3IgdXNlclwiIH0sIHsgc3RhdHVzOiA0MDAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgYWN0aW9uID0gYWN0aW9uRnJvbUV2ZW50KGV2ZW50KTtcclxuICAgIGlmIChhY3Rpb24gJiYgIWNhbih1c2VyLnJvbGUgYXMgUm9sZSwgYWN0aW9uKSkge1xyXG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogXCJGb3JiaWRkZW5cIiB9LCB7IHN0YXR1czogNDAzIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IG5vdyA9IERhdGUubm93KCk7XHJcblxyXG4gICAgLy8gQ2hhdCBwdWJsaWMgKHJvb20pXHJcbiAgICBpZiAoZXZlbnQgPT09IFwiY2hhdFwiKSB7XHJcbiAgICAgIGNvbnN0IGlkID0gU3RyaW5nKHBheWxvYWQ/LmlkIHx8IGAke25vd30tJHtNYXRoLnJhbmRvbSgpLnRvU3RyaW5nKDM2KS5zbGljZSgyLCA4KX1gKTtcclxuICAgICAgY29uc3QgdGV4dCA9IFN0cmluZyhwYXlsb2FkPy50ZXh0IHx8IFwiXCIpLnNsaWNlKDAsIDIwMDApO1xyXG4gICAgICBhZGRDaGF0TWVzc2FnZShyb29tLCB7IGlkLCByb29tLCB1c2VyLCB0ZXh0LCB0czogbm93IH0pO1xyXG5cclxuICAgICAgaHViLmJyb2FkY2FzdChyb29tLCBcImNoYXRcIiwgeyB1c2VyLCBwYXlsb2FkOiB7IGlkLCB0ZXh0IH0sIHRzOiBub3cgfSk7XHJcblxyXG4gICAgICBhZGRBdWRpdCh7XHJcbiAgICAgICAgdHM6IG5vdywgcm9vbSwgZXZlbnQ6IFwiY2hhdFwiLCB1c2VyLFxyXG4gICAgICAgIHBheWxvYWQ6IHsgaWQsIHRleHQgfSxcclxuICAgICAgICBzdW1tYXJ5OiBgJHt1c2VyLm5hbWV9IGEgZW52b3nDqSB1biBtZXNzYWdlOiBcIiR7dGV4dC5zbGljZSgwLCA2MCl9XCJgLFxyXG4gICAgICB9KTtcclxuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgb2s6IHRydWUgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gQ2hhdCBwcml2w6kgKERNKVxyXG4gICAgaWYgKGV2ZW50ID09PSBcImRtXCIpIHtcclxuICAgICAgY29uc3QgdG9Vc2VySWQgPSBTdHJpbmcocGF5bG9hZD8udG9Vc2VySWQgfHwgXCJcIik7XHJcbiAgICAgIGNvbnN0IGlkID0gU3RyaW5nKHBheWxvYWQ/LmlkIHx8IGAke25vd30tJHtNYXRoLnJhbmRvbSgpLnRvU3RyaW5nKDM2KS5zbGljZSgyLCA4KX1gKTtcclxuICAgICAgY29uc3QgdGV4dCA9IFN0cmluZyhwYXlsb2FkPy50ZXh0IHx8IFwiXCIpLnNsaWNlKDAsIDIwMDApO1xyXG4gICAgICBpZiAoIXRvVXNlcklkIHx8ICF0ZXh0KSB7XHJcbiAgICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6IFwiTWlzc2luZyB0b1VzZXJJZCBvciB0ZXh0XCIgfSwgeyBzdGF0dXM6IDQwMCB9KTtcclxuICAgICAgfVxyXG4gICAgICBjb25zdCBkbUtleSA9IGRtUm9vbSh1c2VyLmlkLCB0b1VzZXJJZCk7XHJcblxyXG4gICAgICBhZGRDaGF0TWVzc2FnZShkbUtleSwgeyBpZCwgcm9vbTogZG1LZXksIHVzZXIsIHRleHQsIHRzOiBub3cgfSk7XHJcblxyXG4gICAgICAvLyBEaWZmdXNpb24gZGFucyBsYSByb29tIERNIChzaSBs4oCZYXV0cmUgYSBvdXZlcnQgbGEgbcOqbWUgY29udmVyc2F0aW9uKVxyXG4gICAgICBodWIuYnJvYWRjYXN0KGRtS2V5LCBcImRtXCIsIHsgdXNlciwgcGF5bG9hZDogeyBpZCwgdGV4dCwgdG9Vc2VySWQgfSwgdHM6IG5vdyB9KTtcclxuICAgICAgLy8gRXQgZGlmZnVzaW9uIHN1ciBsZSBjYW5hbCBwZXJzb25uZWwgZHUgZGVzdGluYXRhaXJlIChwb3VyIG5vdGlmaWNhdGlvbi9jb25zb21tYXRpb24gaG9ycyBETSBvdXZlcnQpXHJcbiAgICAgIGh1Yi5icm9hZGNhc3QoYHVzZXI6JHt0b1VzZXJJZH1gLCBcImRtXCIsIHsgdXNlciwgcGF5bG9hZDogeyBpZCwgdGV4dCwgdG9Vc2VySWQgfSwgdHM6IG5vdyB9KTtcclxuXHJcbiAgICAgIGFkZEF1ZGl0KHtcclxuICAgICAgICB0czogbm93LCByb29tOiBkbUtleSwgZXZlbnQ6IFwiZG1cIiwgdXNlcixcclxuICAgICAgICBwYXlsb2FkOiB7IGlkLCB0ZXh0LCB0b1VzZXJJZCB9LFxyXG4gICAgICAgIHN1bW1hcnk6IGAke3VzZXIubmFtZX0gYSBlbnZvecOpIHVuIG1lc3NhZ2UgcHJpdsOpIMOgICR7dG9Vc2VySWR9OiBcIiR7dGV4dC5zbGljZSgwLCA2MCl9XCJgLFxyXG4gICAgICB9KTtcclxuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgb2s6IHRydWUgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gQXV0cmVzIMOpdsOpbmVtZW50c1xyXG4gICAgY29uc3QgZW52ZWxvcGUgPSB7IHVzZXIsIHBheWxvYWQsIHRzOiBub3cgfTtcclxuICAgIGh1Yi5icm9hZGNhc3Qocm9vbSwgZXZlbnQsIGVudmVsb3BlKTtcclxuICAgIGFkZEF1ZGl0KHtcclxuICAgICAgdHM6IGVudmVsb3BlLnRzLFxyXG4gICAgICByb29tLFxyXG4gICAgICBldmVudCxcclxuICAgICAgdXNlcixcclxuICAgICAgcGF5bG9hZDogc2FuaXRpemVQYXlsb2FkKGV2ZW50LCBwYXlsb2FkKSxcclxuICAgICAgc3VtbWFyeTogc3VtbWFyaXplKGV2ZW50LCB1c2VyLCBwYXlsb2FkKSxcclxuICAgIH0pO1xyXG5cclxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IG9rOiB0cnVlIH0pO1xyXG4gIH0gY2F0Y2ggKGU6IGFueSkge1xyXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6IGU/Lm1lc3NhZ2UgfHwgXCJzZXJ2ZXIgZXJyb3JcIiB9LCB7IHN0YXR1czogNTAwIH0pO1xyXG4gIH1cclxufVxyXG5cclxuZnVuY3Rpb24gc2FuaXRpemVQYXlsb2FkKGV2ZW50OiBzdHJpbmcsIHBheWxvYWQ6IGFueSkge1xyXG4gIGlmIChldmVudCA9PT0gXCJjaGF0XCIpIHtcclxuICAgIHJldHVybiB7IGlkOiBwYXlsb2FkPy5pZCwgdGV4dDogU3RyaW5nKHBheWxvYWQ/LnRleHQgfHwgXCJcIikuc2xpY2UoMCwgMzAwKSB9O1xyXG4gIH1cclxuICBpZiAoZXZlbnQgPT09IFwiY3Vyc29yXCIpIHJldHVybiB7IHg6IE51bWJlcihwYXlsb2FkPy54KSwgeTogTnVtYmVyKHBheWxvYWQ/LnkpIH07XHJcbiAgcmV0dXJuIHBheWxvYWQgPz8ge307XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHN1bW1hcml6ZShldmVudDogc3RyaW5nLCB1c2VyOiBhbnksIHBheWxvYWQ6IGFueSkge1xyXG4gIGlmIChldmVudCA9PT0gXCJjaGF0XCIpIHJldHVybiBgJHt1c2VyLm5hbWV9IGEgZW52b3nDqSB1biBtZXNzYWdlOiBcIiR7U3RyaW5nKHBheWxvYWQ/LnRleHQgfHwgXCJcIikuc2xpY2UoMCwgNjApfVwiYDtcclxuICBpZiAoZXZlbnQgPT09IFwiY3Vyc29yXCIpIHJldHVybiBgJHt1c2VyLm5hbWV9IGEgYm91Z8OpIHNvbiBjdXJzZXVyYDtcclxuICByZXR1cm4gYCR7dXNlci5uYW1lfSBhIGVmZmVjdHXDqSBsJ2FjdGlvbiBcIiR7ZXZlbnR9XCJgO1xyXG59Il0sIm5hbWVzIjpbIk5leHRSZXNwb25zZSIsImh1YiIsImFkZEF1ZGl0IiwiYWRkQ2hhdE1lc3NhZ2UiLCJkbVJvb20iLCJyb2xlTWF0cml4IiwiY2hlZiIsIm1hbmFnZXIiLCJhc3Npc3RhbnQiLCJlbXBsb3llIiwiY2FuIiwicm9sZSIsImFjdGlvbiIsImluY2x1ZGVzIiwiYWN0aW9uRnJvbUV2ZW50IiwiZXZlbnQiLCJydW50aW1lIiwiUE9TVCIsInJlcSIsImJvZHkiLCJqc29uIiwicm9vbSIsInBheWxvYWQiLCJ1c2VyIiwiaWQiLCJuYW1lIiwiZXJyb3IiLCJzdGF0dXMiLCJub3ciLCJEYXRlIiwiU3RyaW5nIiwiTWF0aCIsInJhbmRvbSIsInRvU3RyaW5nIiwic2xpY2UiLCJ0ZXh0IiwidHMiLCJicm9hZGNhc3QiLCJzdW1tYXJ5Iiwib2siLCJ0b1VzZXJJZCIsImRtS2V5IiwiZW52ZWxvcGUiLCJzYW5pdGl6ZVBheWxvYWQiLCJzdW1tYXJpemUiLCJlIiwibWVzc2FnZSIsIngiLCJOdW1iZXIiLCJ5Il0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/app/api/realtime/emit/route.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/audit/store.ts":
/*!********************************!*\
  !*** ./src/lib/audit/store.ts ***!
  \********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   addAudit: () => (/* binding */ addAudit),\n/* harmony export */   listAudit: () => (/* binding */ listAudit)\n/* harmony export */ });\nconst g = globalThis;\nif (!g.__AUDIT_EVENTS) g.__AUDIT_EVENTS = [];\nconst events = g.__AUDIT_EVENTS;\nfunction addAudit(ev) {\n    const id = `${Date.now()}-${Math.random().toString(36).slice(2, 8)}`;\n    const record = {\n        id,\n        ...ev\n    };\n    events.push(record);\n    if (events.length > 1000) events.splice(0, events.length - 1000);\n    return record;\n}\nfunction listAudit(limit = 200) {\n    return events.slice(-limit);\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL2F1ZGl0L3N0b3JlLnRzIiwibWFwcGluZ3MiOiI7Ozs7O0FBYUEsTUFBTUEsSUFBSUM7QUFDVixJQUFJLENBQUNELEVBQUVFLGNBQWMsRUFBRUYsRUFBRUUsY0FBYyxHQUFHLEVBQUU7QUFDNUMsTUFBTUMsU0FBdUJILEVBQUVFLGNBQWM7QUFFdEMsU0FBU0UsU0FBU0MsRUFBMEI7SUFDakQsTUFBTUMsS0FBSyxDQUFDLEVBQUVDLEtBQUtDLEdBQUcsR0FBRyxDQUFDLEVBQUVDLEtBQUtDLE1BQU0sR0FBR0MsUUFBUSxDQUFDLElBQUlDLEtBQUssQ0FBQyxHQUFHLEdBQUcsQ0FBQztJQUNwRSxNQUFNQyxTQUFxQjtRQUFFUDtRQUFJLEdBQUdELEVBQUU7SUFBQztJQUN2Q0YsT0FBT1csSUFBSSxDQUFDRDtJQUNaLElBQUlWLE9BQU9ZLE1BQU0sR0FBRyxNQUFNWixPQUFPYSxNQUFNLENBQUMsR0FBR2IsT0FBT1ksTUFBTSxHQUFHO0lBQzNELE9BQU9GO0FBQ1Q7QUFFTyxTQUFTSSxVQUFVQyxRQUFRLEdBQUc7SUFDbkMsT0FBT2YsT0FBT1MsS0FBSyxDQUFDLENBQUNNO0FBQ3ZCIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vcGVwaXRlLW1haWwtcHJvdG8vLi9zcmMvbGliL2F1ZGl0L3N0b3JlLnRzP2NhMzgiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHR5cGUgeyBSb2xlIH0gZnJvbSBcIi4uL2F1dGgvcm9sZXNcIjtcclxuXHJcbmV4cG9ydCB0eXBlIEF1ZGl0VXNlciA9IHsgaWQ6IHN0cmluZzsgbmFtZTogc3RyaW5nOyByb2xlOiBSb2xlIH07XHJcbmV4cG9ydCB0eXBlIEF1ZGl0RXZlbnQgPSB7XHJcbiAgaWQ6IHN0cmluZztcclxuICB0czogbnVtYmVyO1xyXG4gIHJvb206IHN0cmluZztcclxuICBldmVudDogc3RyaW5nO1xyXG4gIHVzZXI6IEF1ZGl0VXNlcjtcclxuICBwYXlsb2FkOiBhbnk7XHJcbiAgc3VtbWFyeTogc3RyaW5nO1xyXG59O1xyXG5cclxuY29uc3QgZyA9IGdsb2JhbFRoaXMgYXMgYW55O1xyXG5pZiAoIWcuX19BVURJVF9FVkVOVFMpIGcuX19BVURJVF9FVkVOVFMgPSBbXSBhcyBBdWRpdEV2ZW50W107XHJcbmNvbnN0IGV2ZW50czogQXVkaXRFdmVudFtdID0gZy5fX0FVRElUX0VWRU5UUztcclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBhZGRBdWRpdChldjogT21pdDxBdWRpdEV2ZW50LCBcImlkXCI+KSB7XHJcbiAgY29uc3QgaWQgPSBgJHtEYXRlLm5vdygpfS0ke01hdGgucmFuZG9tKCkudG9TdHJpbmcoMzYpLnNsaWNlKDIsIDgpfWA7XHJcbiAgY29uc3QgcmVjb3JkOiBBdWRpdEV2ZW50ID0geyBpZCwgLi4uZXYgfTtcclxuICBldmVudHMucHVzaChyZWNvcmQpO1xyXG4gIGlmIChldmVudHMubGVuZ3RoID4gMTAwMCkgZXZlbnRzLnNwbGljZSgwLCBldmVudHMubGVuZ3RoIC0gMTAwMCk7XHJcbiAgcmV0dXJuIHJlY29yZDtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGxpc3RBdWRpdChsaW1pdCA9IDIwMCk6IEF1ZGl0RXZlbnRbXSB7XHJcbiAgcmV0dXJuIGV2ZW50cy5zbGljZSgtbGltaXQpO1xyXG59Il0sIm5hbWVzIjpbImciLCJnbG9iYWxUaGlzIiwiX19BVURJVF9FVkVOVFMiLCJldmVudHMiLCJhZGRBdWRpdCIsImV2IiwiaWQiLCJEYXRlIiwibm93IiwiTWF0aCIsInJhbmRvbSIsInRvU3RyaW5nIiwic2xpY2UiLCJyZWNvcmQiLCJwdXNoIiwibGVuZ3RoIiwic3BsaWNlIiwibGlzdEF1ZGl0IiwibGltaXQiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/audit/store.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/realtime/chatStore.ts":
/*!***************************************!*\
  !*** ./src/lib/realtime/chatStore.ts ***!
  \***************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   addChatMessage: () => (/* binding */ addChatMessage),\n/* harmony export */   dmRoom: () => (/* binding */ dmRoom),\n/* harmony export */   listChatMessages: () => (/* binding */ listChatMessages)\n/* harmony export */ });\n// Petit store mémoire pour l’historique des chats par \"room\".\n// Room peut être une room publique (ex: \"room:demo-room\") ou une room de DM (ex: \"dm:u-a:u-b\").\nconst g = globalThis;\nif (!g.__CHAT_STORE__) g.__CHAT_STORE__ = new Map();\nconst store = g.__CHAT_STORE__;\nfunction addChatMessage(room, msg) {\n    if (!store.has(room)) store.set(room, []);\n    const arr = store.get(room);\n    arr.push(msg);\n    // Conserver les 500 derniers\n    if (arr.length > 500) arr.splice(0, arr.length - 500);\n    return msg;\n}\nfunction listChatMessages(room, limit = 200) {\n    const arr = store.get(room) || [];\n    return arr.slice(-limit);\n}\n// Room de DM stable entre deux utilisateurs (ordre trié)\nfunction dmRoom(a, b) {\n    const [x, y] = a < b ? [\n        a,\n        b\n    ] : [\n        b,\n        a\n    ];\n    return `dm:${x}:${y}`;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL3JlYWx0aW1lL2NoYXRTdG9yZS50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQSw4REFBOEQ7QUFDOUQsZ0dBQWdHO0FBYWhHLE1BQU1BLElBQUlDO0FBQ1YsSUFBSSxDQUFDRCxFQUFFRSxjQUFjLEVBQUVGLEVBQUVFLGNBQWMsR0FBRyxJQUFJQztBQUM5QyxNQUFNQyxRQUFvQ0osRUFBRUUsY0FBYztBQUVuRCxTQUFTRyxlQUFlQyxJQUFZLEVBQUVDLEdBQWdCO0lBQzNELElBQUksQ0FBQ0gsTUFBTUksR0FBRyxDQUFDRixPQUFPRixNQUFNSyxHQUFHLENBQUNILE1BQU0sRUFBRTtJQUN4QyxNQUFNSSxNQUFNTixNQUFNTyxHQUFHLENBQUNMO0lBQ3RCSSxJQUFJRSxJQUFJLENBQUNMO0lBQ1QsNkJBQTZCO0lBQzdCLElBQUlHLElBQUlHLE1BQU0sR0FBRyxLQUFLSCxJQUFJSSxNQUFNLENBQUMsR0FBR0osSUFBSUcsTUFBTSxHQUFHO0lBQ2pELE9BQU9OO0FBQ1Q7QUFFTyxTQUFTUSxpQkFBaUJULElBQVksRUFBRVUsUUFBUSxHQUFHO0lBQ3hELE1BQU1OLE1BQU1OLE1BQU1PLEdBQUcsQ0FBQ0wsU0FBUyxFQUFFO0lBQ2pDLE9BQU9JLElBQUlPLEtBQUssQ0FBQyxDQUFDRDtBQUNwQjtBQUVBLHlEQUF5RDtBQUNsRCxTQUFTRSxPQUFPQyxDQUFTLEVBQUVDLENBQVM7SUFDekMsTUFBTSxDQUFDQyxHQUFHQyxFQUFFLEdBQUdILElBQUlDLElBQUk7UUFBQ0Q7UUFBR0M7S0FBRSxHQUFHO1FBQUNBO1FBQUdEO0tBQUU7SUFDdEMsT0FBTyxDQUFDLEdBQUcsRUFBRUUsRUFBRSxDQUFDLEVBQUVDLEVBQUUsQ0FBQztBQUN2QiIsInNvdXJjZXMiOlsid2VicGFjazovL3BlcGl0ZS1tYWlsLXByb3RvLy4vc3JjL2xpYi9yZWFsdGltZS9jaGF0U3RvcmUudHM/NmFmMSJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBQZXRpdCBzdG9yZSBtw6ltb2lyZSBwb3VyIGzigJloaXN0b3JpcXVlIGRlcyBjaGF0cyBwYXIgXCJyb29tXCIuXHJcbi8vIFJvb20gcGV1dCDDqnRyZSB1bmUgcm9vbSBwdWJsaXF1ZSAoZXg6IFwicm9vbTpkZW1vLXJvb21cIikgb3UgdW5lIHJvb20gZGUgRE0gKGV4OiBcImRtOnUtYTp1LWJcIikuXHJcblxyXG5leHBvcnQgdHlwZSBSb2xlID0gXCJjaGVmXCIgfCBcIm1hbmFnZXJcIiB8IFwiYXNzaXN0YW50XCIgfCBcImVtcGxveWVcIjtcclxuZXhwb3J0IHR5cGUgUlRVc2VyID0geyBpZDogc3RyaW5nOyBuYW1lOiBzdHJpbmc7IHJvbGU6IFJvbGUgfTtcclxuXHJcbmV4cG9ydCB0eXBlIENoYXRNZXNzYWdlID0ge1xyXG4gIGlkOiBzdHJpbmc7XHJcbiAgcm9vbTogc3RyaW5nO1xyXG4gIHVzZXI6IFJUVXNlcjtcclxuICB0ZXh0OiBzdHJpbmc7XHJcbiAgdHM6IG51bWJlcjtcclxufTtcclxuXHJcbmNvbnN0IGcgPSBnbG9iYWxUaGlzIGFzIGFueTtcclxuaWYgKCFnLl9fQ0hBVF9TVE9SRV9fKSBnLl9fQ0hBVF9TVE9SRV9fID0gbmV3IE1hcDxzdHJpbmcsIENoYXRNZXNzYWdlW10+KCk7XHJcbmNvbnN0IHN0b3JlOiBNYXA8c3RyaW5nLCBDaGF0TWVzc2FnZVtdPiA9IGcuX19DSEFUX1NUT1JFX187XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gYWRkQ2hhdE1lc3NhZ2Uocm9vbTogc3RyaW5nLCBtc2c6IENoYXRNZXNzYWdlKSB7XHJcbiAgaWYgKCFzdG9yZS5oYXMocm9vbSkpIHN0b3JlLnNldChyb29tLCBbXSk7XHJcbiAgY29uc3QgYXJyID0gc3RvcmUuZ2V0KHJvb20pITtcclxuICBhcnIucHVzaChtc2cpO1xyXG4gIC8vIENvbnNlcnZlciBsZXMgNTAwIGRlcm5pZXJzXHJcbiAgaWYgKGFyci5sZW5ndGggPiA1MDApIGFyci5zcGxpY2UoMCwgYXJyLmxlbmd0aCAtIDUwMCk7XHJcbiAgcmV0dXJuIG1zZztcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGxpc3RDaGF0TWVzc2FnZXMocm9vbTogc3RyaW5nLCBsaW1pdCA9IDIwMCkge1xyXG4gIGNvbnN0IGFyciA9IHN0b3JlLmdldChyb29tKSB8fCBbXTtcclxuICByZXR1cm4gYXJyLnNsaWNlKC1saW1pdCk7XHJcbn1cclxuXHJcbi8vIFJvb20gZGUgRE0gc3RhYmxlIGVudHJlIGRldXggdXRpbGlzYXRldXJzIChvcmRyZSB0cmnDqSlcclxuZXhwb3J0IGZ1bmN0aW9uIGRtUm9vbShhOiBzdHJpbmcsIGI6IHN0cmluZykge1xyXG4gIGNvbnN0IFt4LCB5XSA9IGEgPCBiID8gW2EsIGJdIDogW2IsIGFdO1xyXG4gIHJldHVybiBgZG06JHt4fToke3l9YDtcclxufSJdLCJuYW1lcyI6WyJnIiwiZ2xvYmFsVGhpcyIsIl9fQ0hBVF9TVE9SRV9fIiwiTWFwIiwic3RvcmUiLCJhZGRDaGF0TWVzc2FnZSIsInJvb20iLCJtc2ciLCJoYXMiLCJzZXQiLCJhcnIiLCJnZXQiLCJwdXNoIiwibGVuZ3RoIiwic3BsaWNlIiwibGlzdENoYXRNZXNzYWdlcyIsImxpbWl0Iiwic2xpY2UiLCJkbVJvb20iLCJhIiwiYiIsIngiLCJ5Il0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/realtime/chatStore.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/realtime/hub.ts":
/*!*********************************!*\
  !*** ./src/lib/realtime/hub.ts ***!
  \*********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   hub: () => (/* binding */ hub)\n/* harmony export */ });\nclass Hub {\n    addClient(room, user, send) {\n        const id = `${Date.now()}-${Math.random().toString(36).slice(2, 8)}`;\n        const c = {\n            id,\n            room,\n            user,\n            send\n        };\n        if (!this.rooms.has(room)) this.rooms.set(room, new Map());\n        this.rooms.get(room).set(id, c);\n        this.broadcast(room, \"presence\", {\n            type: \"join\",\n            user,\n            members: this.members(room)\n        });\n        return id;\n    }\n    removeClient(room, id) {\n        const group = this.rooms.get(room);\n        if (!group) return;\n        const user = group.get(id)?.user;\n        group.delete(id);\n        if (user) this.broadcast(room, \"presence\", {\n            type: \"leave\",\n            user,\n            members: this.members(room)\n        });\n        if (group.size === 0) this.rooms.delete(room);\n    }\n    broadcast(room, event, data) {\n        const group = this.rooms.get(room);\n        if (!group) return;\n        for (const c of group.values()){\n            try {\n                c.send(event, {\n                    ...data\n                });\n            } catch  {}\n        }\n    }\n    members(room) {\n        const group = this.rooms.get(room);\n        if (!group) return [];\n        return Array.from(group.values()).map((c)=>c.user);\n    }\n    constructor(){\n        this.rooms = new Map();\n    }\n}\nconst g = globalThis;\nif (!g.__RT_HUB) g.__RT_HUB = new Hub();\nconst hub = g.__RT_HUB;\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL3JlYWx0aW1lL2h1Yi50cyIsIm1hcHBpbmdzIjoiOzs7O0FBWUEsTUFBTUE7SUFHSkMsVUFBVUMsSUFBWSxFQUFFQyxJQUFZLEVBQUVDLElBQVksRUFBRTtRQUNsRCxNQUFNQyxLQUFLLENBQUMsRUFBRUMsS0FBS0MsR0FBRyxHQUFHLENBQUMsRUFBRUMsS0FBS0MsTUFBTSxHQUFHQyxRQUFRLENBQUMsSUFBSUMsS0FBSyxDQUFDLEdBQUcsR0FBRyxDQUFDO1FBQ3BFLE1BQU1DLElBQVk7WUFBRVA7WUFBSUg7WUFBTUM7WUFBTUM7UUFBSztRQUN6QyxJQUFJLENBQUMsSUFBSSxDQUFDUyxLQUFLLENBQUNDLEdBQUcsQ0FBQ1osT0FBTyxJQUFJLENBQUNXLEtBQUssQ0FBQ0UsR0FBRyxDQUFDYixNQUFNLElBQUljO1FBQ3BELElBQUksQ0FBQ0gsS0FBSyxDQUFDSSxHQUFHLENBQUNmLE1BQU9hLEdBQUcsQ0FBQ1YsSUFBSU87UUFDOUIsSUFBSSxDQUFDTSxTQUFTLENBQUNoQixNQUFNLFlBQVk7WUFBRWlCLE1BQU07WUFBUWhCO1lBQU1pQixTQUFTLElBQUksQ0FBQ0EsT0FBTyxDQUFDbEI7UUFBTTtRQUNuRixPQUFPRztJQUNUO0lBRUFnQixhQUFhbkIsSUFBWSxFQUFFRyxFQUFVLEVBQUU7UUFDckMsTUFBTWlCLFFBQVEsSUFBSSxDQUFDVCxLQUFLLENBQUNJLEdBQUcsQ0FBQ2Y7UUFDN0IsSUFBSSxDQUFDb0IsT0FBTztRQUNaLE1BQU1uQixPQUFPbUIsTUFBTUwsR0FBRyxDQUFDWixLQUFLRjtRQUM1Qm1CLE1BQU1DLE1BQU0sQ0FBQ2xCO1FBQ2IsSUFBSUYsTUFBTSxJQUFJLENBQUNlLFNBQVMsQ0FBQ2hCLE1BQU0sWUFBWTtZQUFFaUIsTUFBTTtZQUFTaEI7WUFBTWlCLFNBQVMsSUFBSSxDQUFDQSxPQUFPLENBQUNsQjtRQUFNO1FBQzlGLElBQUlvQixNQUFNRSxJQUFJLEtBQUssR0FBRyxJQUFJLENBQUNYLEtBQUssQ0FBQ1UsTUFBTSxDQUFDckI7SUFDMUM7SUFFQWdCLFVBQVVoQixJQUFZLEVBQUV1QixLQUFhLEVBQUVDLElBQVMsRUFBRTtRQUNoRCxNQUFNSixRQUFRLElBQUksQ0FBQ1QsS0FBSyxDQUFDSSxHQUFHLENBQUNmO1FBQzdCLElBQUksQ0FBQ29CLE9BQU87UUFDWixLQUFLLE1BQU1WLEtBQUtVLE1BQU1LLE1BQU0sR0FBSTtZQUM5QixJQUFJO2dCQUNGZixFQUFFUixJQUFJLENBQUNxQixPQUFPO29CQUFFLEdBQUdDLElBQUk7Z0JBQUM7WUFDMUIsRUFBRSxPQUFNLENBQUM7UUFDWDtJQUNGO0lBRUFOLFFBQVFsQixJQUFZLEVBQUU7UUFDcEIsTUFBTW9CLFFBQVEsSUFBSSxDQUFDVCxLQUFLLENBQUNJLEdBQUcsQ0FBQ2Y7UUFDN0IsSUFBSSxDQUFDb0IsT0FBTyxPQUFPLEVBQUU7UUFDckIsT0FBT00sTUFBTUMsSUFBSSxDQUFDUCxNQUFNSyxNQUFNLElBQUlHLEdBQUcsQ0FBQyxDQUFDbEIsSUFBTUEsRUFBRVQsSUFBSTtJQUNyRDs7YUFsQ1FVLFFBQTBDLElBQUlHOztBQW1DeEQ7QUFFQSxNQUFNZSxJQUFJQztBQUNWLElBQUksQ0FBQ0QsRUFBRUUsUUFBUSxFQUFFRixFQUFFRSxRQUFRLEdBQUcsSUFBSWpDO0FBQzNCLE1BQU1rQyxNQUFXSCxFQUFFRSxRQUFRLENBQUMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9wZXBpdGUtbWFpbC1wcm90by8uL3NyYy9saWIvcmVhbHRpbWUvaHViLnRzPzJmM2YiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHR5cGUgeyBSb2xlIH0gZnJvbSBcIi4uL2F1dGgvcm9sZXNcIjtcclxuXHJcbmV4cG9ydCB0eXBlIFJUVXNlciA9IHsgaWQ6IHN0cmluZzsgbmFtZTogc3RyaW5nOyByb2xlOiBSb2xlIH07XHJcbnR5cGUgU2VuZEZuID0gKGV2ZW50OiBzdHJpbmcsIGRhdGE6IGFueSkgPT4gdm9pZDtcclxuXHJcbnR5cGUgQ2xpZW50ID0ge1xyXG4gIGlkOiBzdHJpbmc7XHJcbiAgcm9vbTogc3RyaW5nO1xyXG4gIHVzZXI6IFJUVXNlcjtcclxuICBzZW5kOiBTZW5kRm47XHJcbn07XHJcblxyXG5jbGFzcyBIdWIge1xyXG4gIHByaXZhdGUgcm9vbXM6IE1hcDxzdHJpbmcsIE1hcDxzdHJpbmcsIENsaWVudD4+ID0gbmV3IE1hcCgpO1xyXG5cclxuICBhZGRDbGllbnQocm9vbTogc3RyaW5nLCB1c2VyOiBSVFVzZXIsIHNlbmQ6IFNlbmRGbikge1xyXG4gICAgY29uc3QgaWQgPSBgJHtEYXRlLm5vdygpfS0ke01hdGgucmFuZG9tKCkudG9TdHJpbmcoMzYpLnNsaWNlKDIsIDgpfWA7XHJcbiAgICBjb25zdCBjOiBDbGllbnQgPSB7IGlkLCByb29tLCB1c2VyLCBzZW5kIH07XHJcbiAgICBpZiAoIXRoaXMucm9vbXMuaGFzKHJvb20pKSB0aGlzLnJvb21zLnNldChyb29tLCBuZXcgTWFwKCkpO1xyXG4gICAgdGhpcy5yb29tcy5nZXQocm9vbSkhLnNldChpZCwgYyk7XHJcbiAgICB0aGlzLmJyb2FkY2FzdChyb29tLCBcInByZXNlbmNlXCIsIHsgdHlwZTogXCJqb2luXCIsIHVzZXIsIG1lbWJlcnM6IHRoaXMubWVtYmVycyhyb29tKSB9KTtcclxuICAgIHJldHVybiBpZDtcclxuICB9XHJcblxyXG4gIHJlbW92ZUNsaWVudChyb29tOiBzdHJpbmcsIGlkOiBzdHJpbmcpIHtcclxuICAgIGNvbnN0IGdyb3VwID0gdGhpcy5yb29tcy5nZXQocm9vbSk7XHJcbiAgICBpZiAoIWdyb3VwKSByZXR1cm47XHJcbiAgICBjb25zdCB1c2VyID0gZ3JvdXAuZ2V0KGlkKT8udXNlcjtcclxuICAgIGdyb3VwLmRlbGV0ZShpZCk7XHJcbiAgICBpZiAodXNlcikgdGhpcy5icm9hZGNhc3Qocm9vbSwgXCJwcmVzZW5jZVwiLCB7IHR5cGU6IFwibGVhdmVcIiwgdXNlciwgbWVtYmVyczogdGhpcy5tZW1iZXJzKHJvb20pIH0pO1xyXG4gICAgaWYgKGdyb3VwLnNpemUgPT09IDApIHRoaXMucm9vbXMuZGVsZXRlKHJvb20pO1xyXG4gIH1cclxuXHJcbiAgYnJvYWRjYXN0KHJvb206IHN0cmluZywgZXZlbnQ6IHN0cmluZywgZGF0YTogYW55KSB7XHJcbiAgICBjb25zdCBncm91cCA9IHRoaXMucm9vbXMuZ2V0KHJvb20pO1xyXG4gICAgaWYgKCFncm91cCkgcmV0dXJuO1xyXG4gICAgZm9yIChjb25zdCBjIG9mIGdyb3VwLnZhbHVlcygpKSB7XHJcbiAgICAgIHRyeSB7XHJcbiAgICAgICAgYy5zZW5kKGV2ZW50LCB7IC4uLmRhdGEgfSk7XHJcbiAgICAgIH0gY2F0Y2gge31cclxuICAgIH1cclxuICB9XHJcblxyXG4gIG1lbWJlcnMocm9vbTogc3RyaW5nKSB7XHJcbiAgICBjb25zdCBncm91cCA9IHRoaXMucm9vbXMuZ2V0KHJvb20pO1xyXG4gICAgaWYgKCFncm91cCkgcmV0dXJuIFtdO1xyXG4gICAgcmV0dXJuIEFycmF5LmZyb20oZ3JvdXAudmFsdWVzKCkpLm1hcCgoYykgPT4gYy51c2VyKTtcclxuICB9XHJcbn1cclxuXHJcbmNvbnN0IGcgPSBnbG9iYWxUaGlzIGFzIGFueTtcclxuaWYgKCFnLl9fUlRfSFVCKSBnLl9fUlRfSFVCID0gbmV3IEh1YigpO1xyXG5leHBvcnQgY29uc3QgaHViOiBIdWIgPSBnLl9fUlRfSFVCOyJdLCJuYW1lcyI6WyJIdWIiLCJhZGRDbGllbnQiLCJyb29tIiwidXNlciIsInNlbmQiLCJpZCIsIkRhdGUiLCJub3ciLCJNYXRoIiwicmFuZG9tIiwidG9TdHJpbmciLCJzbGljZSIsImMiLCJyb29tcyIsImhhcyIsInNldCIsIk1hcCIsImdldCIsImJyb2FkY2FzdCIsInR5cGUiLCJtZW1iZXJzIiwicmVtb3ZlQ2xpZW50IiwiZ3JvdXAiLCJkZWxldGUiLCJzaXplIiwiZXZlbnQiLCJkYXRhIiwidmFsdWVzIiwiQXJyYXkiLCJmcm9tIiwibWFwIiwiZyIsImdsb2JhbFRoaXMiLCJfX1JUX0hVQiIsImh1YiJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/realtime/hub.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Frealtime%2Femit%2Froute&page=%2Fapi%2Frealtime%2Femit%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Frealtime%2Femit%2Froute.ts&appDir=C%3A%5Cpepite-mail-proto%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5Cpepite-mail-proto&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();