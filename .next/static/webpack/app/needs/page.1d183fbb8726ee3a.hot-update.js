"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
self["webpackHotUpdate_N_E"]("app/needs/page",{

/***/ "(app-pages-browser)/./src/lib/needs/firestore.ts":
/*!************************************!*\
  !*** ./src/lib/needs/firestore.ts ***!
  \************************************/
/***/ (function(module, __webpack_exports__, __webpack_require__) {

eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   approveRequest: function() { return /* binding */ approveRequest; },\n/* harmony export */   createNeedRequest: function() { return /* binding */ createNeedRequest; },\n/* harmony export */   executeRequest: function() { return /* binding */ executeRequest; },\n/* harmony export */   rejectRequest: function() { return /* binding */ rejectRequest; },\n/* harmony export */   submitNeedRequest: function() { return /* binding */ submitNeedRequest; },\n/* harmony export */   subscribeMyRequests: function() { return /* binding */ subscribeMyRequests; },\n/* harmony export */   subscribeQueueForRole: function() { return /* binding */ subscribeQueueForRole; }\n/* harmony export */ });\n/* harmony import */ var firebase_firestore__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! firebase/firestore */ \"(app-pages-browser)/./node_modules/firebase/firestore/dist/esm/index.esm.js\");\n/* harmony import */ var _lib_firebase__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @lib/firebase */ \"(app-pages-browser)/./src/lib/firebase.ts\");\n\n\nfunction nowISO() {\n    return new Date().toISOString();\n}\nfunction me() {\n    const u = _lib_firebase__WEBPACK_IMPORTED_MODULE_1__.auth.currentUser;\n    return {\n        uid: (u === null || u === void 0 ? void 0 : u.uid) || \"anon\",\n        email: (u === null || u === void 0 ? void 0 : u.email) || \"\",\n        name: (u === null || u === void 0 ? void 0 : u.displayName) || ((u === null || u === void 0 ? void 0 : u.email) ? u.email.split(\"@\")[0] : \"User\")\n    };\n}\nfunction canTransition(from, to, role) {\n    var _allowed_from;\n    const allowed = {\n        draft: [\n            {\n                to: \"submitted\",\n                by: \"employee\"\n            }\n        ],\n        submitted: [\n            {\n                to: \"manager_approved\",\n                by: \"manager\"\n            },\n            {\n                to: \"rejected\",\n                by: \"manager\"\n            }\n        ],\n        manager_approved: [\n            {\n                to: \"admin_approved\",\n                by: \"admin\"\n            },\n            {\n                to: \"rejected\",\n                by: \"admin\"\n            }\n        ],\n        admin_approved: [\n            {\n                to: \"finance_approved\",\n                by: \"finance\"\n            },\n            {\n                to: \"rejected\",\n                by: \"finance\"\n            }\n        ],\n        finance_approved: [\n            {\n                to: \"fulfilled\",\n                by: \"finance\"\n            }\n        ],\n        rejected: [],\n        fulfilled: []\n    };\n    return ((_allowed_from = allowed[from]) === null || _allowed_from === void 0 ? void 0 : _allowed_from.some((r)=>r.to === to && r.by === role)) || false;\n}\nasync function createNeedRequest(input) {\n    const db = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getFirestore)();\n    var _input_amount, _input_currency, _input_justification, _input_attachments;\n    const ref = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.addDoc)((0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.collection)(db, \"needRequests\"), {\n        title: input.title,\n        description: input.description,\n        amount: (_input_amount = input.amount) !== null && _input_amount !== void 0 ? _input_amount : null,\n        currency: (_input_currency = input.currency) !== null && _input_currency !== void 0 ? _input_currency : \"XOF\",\n        justification: (_input_justification = input.justification) !== null && _input_justification !== void 0 ? _input_justification : \"\",\n        attachments: (_input_attachments = input.attachments) !== null && _input_attachments !== void 0 ? _input_attachments : [],\n        createdBy: me(),\n        createdAt: (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.serverTimestamp)(),\n        lastEventAt: (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.serverTimestamp)(),\n        status: \"draft\",\n        approvals: [],\n        history: [\n            {\n                type: \"created\",\n                at: nowISO(),\n                by: me(),\n                data: {\n                    title: input.title,\n                    amount: input.amount,\n                    currency: input.currency\n                }\n            }\n        ]\n    });\n    return ref.id;\n}\nasync function submitNeedRequest(id) {\n    const db = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getFirestore)();\n    const ref = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.doc)(db, \"needRequests\", id);\n    const r = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDoc)(ref);\n    const cur = r.data();\n    if (!cur) throw new Error(\"Request not found\");\n    if (!canTransition(cur.status, \"submitted\", \"employee\")) throw new Error(\"Transition non autoris\\xe9e\");\n    await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.updateDoc)(ref, {\n        status: \"submitted\",\n        lastEventAt: (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.serverTimestamp)(),\n        history: (cur.history || []).concat([\n            {\n                type: \"submitted\",\n                at: nowISO(),\n                by: me()\n            }\n        ])\n    });\n}\nasync function approveRequest(id, role, comment) {\n    const db = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getFirestore)();\n    const ref = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.doc)(db, \"needRequests\", id);\n    const snap = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDoc)(ref);\n    const cur = snap.data();\n    if (!cur) throw new Error(\"Request not found\");\n    const next = {\n        draft: \"submitted\",\n        submitted: \"manager_approved\",\n        manager_approved: \"admin_approved\",\n        admin_approved: \"finance_approved\",\n        finance_approved: \"fulfilled\",\n        rejected: \"rejected\",\n        fulfilled: \"fulfilled\"\n    };\n    const to = next[cur.status];\n    if (!to || !canTransition(cur.status, to, role)) throw new Error(\"Transition non autoris\\xe9e\");\n    const rec = {\n        role,\n        decision: to === \"rejected\" ? \"rejected\" : \"approved\",\n        comment,\n        at: nowISO(),\n        by: me()\n    };\n    await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.updateDoc)(ref, {\n        status: to,\n        lastEventAt: (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.serverTimestamp)(),\n        approvals: (cur.approvals || []).concat([\n            rec\n        ]),\n        history: (cur.history || []).concat([\n            {\n                type: \"approved_\".concat(role),\n                at: nowISO(),\n                by: me(),\n                data: {\n                    comment\n                }\n            }\n        ])\n    });\n}\nasync function rejectRequest(id, role, comment) {\n    const db = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getFirestore)();\n    const ref = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.doc)(db, \"needRequests\", id);\n    const snap = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDoc)(ref);\n    const cur = snap.data();\n    if (!cur) throw new Error(\"Request not found\");\n    if (!canTransition(cur.status, \"rejected\", role)) throw new Error(\"Transition non autoris\\xe9e\");\n    const rec = {\n        role,\n        decision: \"rejected\",\n        comment,\n        at: nowISO(),\n        by: me()\n    };\n    await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.updateDoc)(ref, {\n        status: \"rejected\",\n        lastEventAt: (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.serverTimestamp)(),\n        approvals: (cur.approvals || []).concat([\n            rec\n        ]),\n        history: (cur.history || []).concat([\n            {\n                type: \"rejected_\".concat(role),\n                at: nowISO(),\n                by: me(),\n                data: {\n                    comment\n                }\n            }\n        ])\n    });\n}\nasync function executeRequest(id, details) {\n    const db = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getFirestore)();\n    const ref = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.doc)(db, \"needRequests\", id);\n    const snap = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDoc)(ref);\n    const cur = snap.data();\n    if (!cur) throw new Error(\"Request not found\");\n    // Finance peut passer de finance_approved -> fulfilled\n    if (cur.status !== \"finance_approved\") throw new Error(\"Non ex\\xe9cutable dans l'\\xe9tat actuel\");\n    await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.updateDoc)(ref, {\n        status: \"fulfilled\",\n        lastEventAt: (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.serverTimestamp)(),\n        history: (cur.history || []).concat([\n            {\n                type: \"executed\",\n                at: nowISO(),\n                by: me(),\n                data: details || {}\n            }\n        ])\n    });\n}\n// Abonnements temps rÃ©el (UI)\nfunction subscribeMyRequests(uid, cb) {\n    const db = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getFirestore)();\n    const q = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.query)((0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.collection)(db, \"needRequests\"), (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.where)(\"createdBy.uid\", \"==\", uid), (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.orderBy)(\"createdAt\", \"desc\"));\n    return (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.onSnapshot)(q, (snap)=>{\n        cb(snap.docs.map((d)=>({\n                id: d.id,\n                ...d.data()\n            })));\n    });\n}\nfunction subscribeQueueForRole(role, cb) {\n    const db = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getFirestore)();\n    let qRef;\n    if (role === \"manager\") {\n        qRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.query)((0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.collection)(db, \"needRequests\"), (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.where)(\"status\", \"==\", \"submitted\"), (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.orderBy)(\"createdAt\", \"desc\"));\n    } else if (role === \"admin\") {\n        qRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.query)((0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.collection)(db, \"needRequests\"), (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.where)(\"status\", \"==\", \"manager_approved\"), (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.orderBy)(\"createdAt\", \"desc\"));\n    } else if (role === \"finance\") {\n        qRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.query)((0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.collection)(db, \"needRequests\"), (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.where)(\"status\", \"in\", [\n            \"admin_approved\",\n            \"finance_approved\"\n        ]), (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.orderBy)(\"createdAt\", \"desc\"));\n    } else {\n        qRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.query)((0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.collection)(db, \"needRequests\"), (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.where)(\"status\", \"==\", \"submitted\"), (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.orderBy)(\"createdAt\", \"desc\"));\n    }\n    return (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.onSnapshot)(qRef, (snap)=>{\n        cb(snap.docs.map((d)=>({\n                id: d.id,\n                ...d.data()\n            })));\n    });\n}\n\n\n;\n    // Wrapped in an IIFE to avoid polluting the global scope\n    ;\n    (function () {\n        var _a, _b;\n        // Legacy CSS implementations will `eval` browser code in a Node.js context\n        // to extract CSS. For backwards compatibility, we need to check we're in a\n        // browser context before continuing.\n        if (typeof self !== 'undefined' &&\n            // AMP / No-JS mode does not inject these helpers:\n            '$RefreshHelpers$' in self) {\n            // @ts-ignore __webpack_module__ is global\n            var currentExports = module.exports;\n            // @ts-ignore __webpack_module__ is global\n            var prevSignature = (_b = (_a = module.hot.data) === null || _a === void 0 ? void 0 : _a.prevSignature) !== null && _b !== void 0 ? _b : null;\n            // This cannot happen in MainTemplate because the exports mismatch between\n            // templating and execution.\n            self.$RefreshHelpers$.registerExportsForReactRefresh(currentExports, module.id);\n            // A module can be accepted automatically based on its exports, e.g. when\n            // it is a Refresh Boundary.\n            if (self.$RefreshHelpers$.isReactRefreshBoundary(currentExports)) {\n                // Save the previous exports signature on update so we can compare the boundary\n                // signatures. We avoid saving exports themselves since it causes memory leaks (https://github.com/vercel/next.js/pull/53797)\n                module.hot.dispose(function (data) {\n                    data.prevSignature =\n                        self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports);\n                });\n                // Unconditionally accept an update to this module, we'll check if it's\n                // still a Refresh Boundary later.\n                // @ts-ignore importMeta is replaced in the loader\n                module.hot.accept();\n                // This field is set when the previous version of this module was a\n                // Refresh Boundary, letting us know we need to check for invalidation or\n                // enqueue an update.\n                if (prevSignature !== null) {\n                    // A boundary can become ineligible if its exports are incompatible\n                    // with the previous exports.\n                    //\n                    // For example, if you add/remove/change exports, we'll want to\n                    // re-execute the importing modules, and force those components to\n                    // re-render. Similarly, if you convert a class component to a\n                    // function, we want to invalidate the boundary.\n                    if (self.$RefreshHelpers$.shouldInvalidateReactRefreshBoundary(prevSignature, self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports))) {\n                        module.hot.invalidate();\n                    }\n                    else {\n                        self.$RefreshHelpers$.scheduleUpdate();\n                    }\n                }\n            }\n            else {\n                // Since we just executed the code for the module, it's possible that the\n                // new exports made it ineligible for being a boundary.\n                // We only care about the case when we were _previously_ a boundary,\n                // because we already accepted this update (accidental side effect).\n                var isNoLongerABoundary = prevSignature !== null;\n                if (isNoLongerABoundary) {\n                    module.hot.invalidate();\n                }\n            }\n        }\n    })();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwcC1wYWdlcy1icm93c2VyKS8uL3NyYy9saWIvbmVlZHMvZmlyZXN0b3JlLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7OztBQUc0QjtBQUNTO0FBR3JDLFNBQVNZO0lBQ1AsT0FBTyxJQUFJQyxPQUFPQyxXQUFXO0FBQy9CO0FBRUEsU0FBU0M7SUFDUCxNQUFNQyxJQUFJTCwrQ0FBSUEsQ0FBQ00sV0FBVztJQUMxQixPQUFPO1FBQ0xDLEtBQUtGLENBQUFBLGNBQUFBLHdCQUFBQSxFQUFHRSxHQUFHLEtBQUk7UUFDZkMsT0FBT0gsQ0FBQUEsY0FBQUEsd0JBQUFBLEVBQUdHLEtBQUssS0FBSTtRQUNuQkMsTUFBTUosQ0FBQUEsY0FBQUEsd0JBQUFBLEVBQUdLLFdBQVcsS0FBS0wsQ0FBQUEsQ0FBQUEsY0FBQUEsd0JBQUFBLEVBQUdHLEtBQUssSUFBR0gsRUFBRUcsS0FBSyxDQUFDRyxLQUFLLENBQUMsSUFBSSxDQUFDLEVBQUUsR0FBRyxNQUFLO0lBQ25FO0FBQ0Y7QUFFQSxTQUFTQyxjQUFjQyxJQUFnQixFQUFFQyxFQUFjLEVBQUVDLElBQWM7UUFtQjlEQztJQWxCUCxNQUFNQSxVQUF1RTtRQUMzRUMsT0FBTztZQUFDO2dCQUFFSCxJQUFJO2dCQUFhSSxJQUFJO1lBQVc7U0FBRTtRQUM1Q0MsV0FBVztZQUNUO2dCQUFFTCxJQUFJO2dCQUFvQkksSUFBSTtZQUFVO1lBQ3hDO2dCQUFFSixJQUFJO2dCQUFZSSxJQUFJO1lBQVU7U0FDakM7UUFDREUsa0JBQWtCO1lBQ2hCO2dCQUFFTixJQUFJO2dCQUFrQkksSUFBSTtZQUFRO1lBQ3BDO2dCQUFFSixJQUFJO2dCQUFZSSxJQUFJO1lBQVE7U0FDL0I7UUFDREcsZ0JBQWdCO1lBQ2Q7Z0JBQUVQLElBQUk7Z0JBQW9CSSxJQUFJO1lBQVU7WUFDeEM7Z0JBQUVKLElBQUk7Z0JBQVlJLElBQUk7WUFBVTtTQUNqQztRQUNESSxrQkFBa0I7WUFBQztnQkFBRVIsSUFBSTtnQkFBYUksSUFBSTtZQUFVO1NBQUU7UUFD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OGUiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtcclxuICBnZXRGaXJlc3RvcmUsIHNlcnZlclRpbWVzdGFtcCwgY29sbGVjdGlvbiwgYWRkRG9jLCBkb2MsIHVwZGF0ZURvYywgZ2V0RG9jLFxyXG4gIG9uU25hcHNob3QsIHF1ZXJ5LCB3aGVyZSwgb3JkZXJCeVxyXG59IGZyb20gXCJmaXJlYmFzZS9maXJlc3RvcmVcIjtcclxuaW1wb3J0IHsgYXV0aCB9IGZyb20gXCJAbGliL2ZpcmViYXNlXCI7XHJcbmltcG9ydCB0eXBlIHsgTmVlZFJlcXVlc3QsIE5lZWRTdGF0dXMsIE5lZWRSb2xlLCBBcHByb3ZhbFJlY29yZCwgVXNlclJlZiB9IGZyb20gXCJAbGliL25lZWRzL3R5cGVzXCI7XHJcblxyXG5mdW5jdGlvbiBub3dJU08oKSB7XHJcbiAgcmV0dXJuIG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKTtcclxufVxyXG5cclxuZnVuY3Rpb24gbWUoKTogVXNlclJlZiB7XHJcbiAgY29uc3QgdSA9IGF1dGguY3VycmVudFVzZXI7XHJcbiAgcmV0dXJuIHtcclxuICAgIHVpZDogdT8udWlkIHx8IFwiYW5vblwiLFxyXG4gICAgZW1haWw6IHU/LmVtYWlsIHx8IFwiXCIsXHJcbiAgICBuYW1lOiB1Py5kaXNwbGF5TmFtZSB8fCAodT8uZW1haWwgPyB1LmVtYWlsLnNwbGl0KFwiQFwiKVswXSA6IFwiVXNlclwiKSxcclxuICB9O1xyXG59XHJcblxyXG5mdW5jdGlvbiBjYW5UcmFuc2l0aW9uKGZyb206IE5lZWRTdGF0dXMsIHRvOiBOZWVkU3RhdHVzLCByb2xlOiBOZWVkUm9sZSk6IGJvb2xlYW4ge1xyXG4gIGNvbnN0IGFsbG93ZWQ6IFJlY29yZDxOZWVkU3RhdHVzLCBBcnJheTx7IHRvOiBOZWVkU3RhdHVzOyBieTogTmVlZFJvbGUgfT4+ID0ge1xyXG4gICAgZHJhZnQ6IFt7IHRvOiBcInN1Ym1pdHRlZFwiLCBieTogXCJlbXBsb3llZVwiIH1dLFxyXG4gICAgc3VibWl0dGVkOiBbXHJcbiAgICAgIHsgdG86IFwibWFuYWdlcl9hcHByb3ZlZFwiLCBieTogXCJtYW5hZ2VyXCIgfSxcclxuICAgICAgeyB0bzogXCJyZWplY3RlZFwiLCBieTogXCJtYW5hZ2VyXCIgfSxcclxuICAgIF0sXHJcbiAgICBtYW5hZ2VyX2FwcHJvdmVkOiBbXHJcbiAgICAgIHsgdG86IFwiYWRtaW5fYXBwcm92ZWRcIiwgYnk6IFwiYWRtaW5cIiB9LFxyXG4gICAgICB7IHRvOiBcInJlamVjdGVkXCIsIGJ5OiBcImFkbWluXCIgfSxcclxuICAgIF0sXHJcbiAgICBhZG1pbl9hcHByb3ZlZDogW1xyXG4gICAgICB7IHRvOiBcImZpbmFuY2VfYXBwcm92ZWRcIiwgYnk6IFwiZmluYW5jZVwiIH0sXHJcbiAgICAgIHsgdG86IFwicmVqZWN0ZWRcIiwgYnk6IFwiZmluYW5jZVwiIH0sXHJcbiAgICBdLFxyXG4gICAgZmluYW5jZV9hcHByb3ZlZDogW3sgdG86IFwiZnVsZmlsbGVkXCIsIGJ5OiBcImZpbmFuY2VcIiB9XSxcclxuICAgIHJlamVjdGVkOiBbXSxcclxuICAgIGZ1bGZpbGxlZDogW10sXHJcbiAgfTtcclxuICByZXR1cm4gYWxsb3dlZFtmcm9tXT8uc29tZSgocikgPT4gci50byA9PT0gdG8gJiYgci5ieSA9PT0gcm9sZSkgfHwgZmFsc2U7XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjcmVhdGVOZWVkUmVxdWVzdChpbnB1dDoge1xyXG4gIHRpdGxlOiBzdHJpbmc7XHJcbiAgZGVzY3JpcHRpb246IHN0cmluZztcclxuICBhbW91bnQ/OiBudW1iZXI7XHJcbiAgY3VycmVuY3k/OiBzdHJpbmc7XHJcbiAganVzdGlmaWNhdGlvbj86IHN0cmluZztcclxuICBhdHRhY2htZW50cz86IE5lZWRSZXF1ZXN0W1wiYXR0YWNobWVudHNcIl07XHJcbn0pOiBQcm9taXNlPHN0cmluZz4ge1xyXG4gIGNvbnN0IGRiID0gZ2V0RmlyZXN0b3JlKCk7XHJcbiAgY29uc3QgcmVmID0gYXdhaXQgYWRkRG9jKGNvbGxlY3Rpb24oZGIsIFwibmVlZFJlcXVlc3RzXCIpLCB7XHJcbiAgICB0aXRsZTogaW5wdXQudGl0bGUsXHJcbiAgICBkZXNjcmlwdGlvbjogaW5wdXQuZGVzY3JpcHRpb24sXHJcbiAgICBhbW91bnQ6IGlucHV0LmFtb3VudCA/PyBudWxsLFxyXG4gICAgY3VycmVuY3k6IGlucHV0LmN1cnJlbmN5ID8/IFwiWE9GXCIsXHJcbiAgICBqdXN0aWZpY2F0aW9uOiBpbnB1dC5qdXN0aWZpY2F0aW9uID8/IFwiXCIsXHJcbiAgICBhdHRhY2htZW50czogaW5wdXQuYXR0YWNobWVudHMgPz8gW10sXHJcbiAgICBjcmVhdGVkQnk6IG1lKCksXHJcbiAgICBjcmVhdGVkQXQ6IHNlcnZlclRpbWVzdGFtcCgpLCAgICAgICAgLy8gT0s6IGNoYW1wIHRvcC1sZXZlbFxyXG4gICAgbGFzdEV2ZW50QXQ6IHNlcnZlclRpbWVzdGFtcCgpLCAgICAgIC8vIE9LOiBjaGFtcCB0b3AtbGV2ZWwgKHBvdXIgdHJpL3JhZnJhw65jaGlzc2VtZW50KVxyXG4gICAgc3RhdHVzOiBcImRyYWZ0XCIsXHJcbiAgICBhcHByb3ZhbHM6IFtdLCAgICAgICAgICAgICAgICAgICAgICAgLy8gUEFTIGRlIHNlcnZlclRpbWVzdGFtcCBkYW5zIGxlcyDDqWzDqW1lbnRzIGTigJlhcnJheVxyXG4gICAgaGlzdG9yeTogW1xyXG4gICAgICB7XHJcbiAgICAgICAgdHlwZTogXCJjcmVhdGVkXCIsXHJcbiAgICAgICAgYXQ6IG5vd0lTTygpLCAgICAgICAgICAgICAgICAgICAgLy8gSG9yb2RhdGFnZSBjbGllbnQgZGFucyBs4oCZYXJyYXkgKGNvbXBhdGlibGUgRmlyZXN0b3JlKVxyXG4gICAgICAgIGJ5OiBtZSgpLFxyXG4gICAgICAgIGRhdGE6IHsgdGl0bGU6IGlucHV0LnRpdGxlLCBhbW91bnQ6IGlucHV0LmFtb3VudCwgY3VycmVuY3k6IGlucHV0LmN1cnJlbmN5IH0sXHJcbiAgICAgIH0sXHJcbiAgICBdLFxyXG4gIH0gYXMgT21pdDxOZWVkUmVxdWVzdCwgXCJpZFwiPik7XHJcbiAgcmV0dXJuIHJlZi5pZDtcclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHN1Ym1pdE5lZWRSZXF1ZXN0KGlkOiBzdHJpbmcpIHtcclxuICBjb25zdCBkYiA9IGdldEZpcmVzdG9yZSgpO1xyXG4gIGNvbnN0IHJlZiA9IGRvYyhkYiwgXCJuZWVkUmVxdWVzdHNcIiwgaWQpO1xyXG4gIGNvbnN0IHIgPSBhd2FpdCBnZXREb2MocmVmKTtcclxuICBjb25zdCBjdXIgPSByLmRhdGEoKSBhcyBOZWVkUmVxdWVzdCB8IHVuZGVmaW5lZDtcclxuICBpZiAoIWN1cikgdGhyb3cgbmV3IEVycm9yKFwiUmVxdWVzdCBub3QgZm91bmRcIik7XHJcbiAgaWYgKCFjYW5UcmFuc2l0aW9uKGN1ci5zdGF0dXMsIFwic3VibWl0dGVkXCIsIFwiZW1wbG95ZWVcIikpIHRocm93IG5ldyBFcnJvcihcIlRyYW5zaXRpb24gbm9uIGF1dG9yaXPDqWVcIik7XHJcbiAgYXdhaXQgdXBkYXRlRG9jKHJlZiwge1xyXG4gICAgc3RhdHVzOiBcInN1Ym1pdHRlZFwiLFxyXG4gICAgbGFzdEV2ZW50QXQ6IHNlcnZlclRpbWVzdGFtcCgpLCAvLyB0b3AtbGV2ZWwgT0tcclxuICAgIGhpc3Rvcnk6IChjdXIuaGlzdG9yeSB8fCBbXSkuY29uY2F0KFtcclxuICAgICAgeyB0eXBlOiBcInN1Ym1pdHRlZFwiLCBhdDogbm93SVNPKCksIGJ5OiBtZSgpIH0sXHJcbiAgICBdKSxcclxuICB9KTtcclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGFwcHJvdmVSZXF1ZXN0KGlkOiBzdHJpbmcsIHJvbGU6IE5lZWRSb2xlLCBjb21tZW50Pzogc3RyaW5nKSB7XHJcbiAgY29uc3QgZGIgPSBnZXRGaXJlc3RvcmUoKTtcclxuICBjb25zdCByZWYgPSBkb2MoZGIsIFwibmVlZFJlcXVlc3RzXCIsIGlkKTtcclxuICBjb25zdCBzbmFwID0gYXdhaXQgZ2V0RG9jKHJlZik7XHJcbiAgY29uc3QgY3VyID0gc25hcC5kYXRhKCkgYXMgTmVlZFJlcXVlc3QgfCB1bmRlZmluZWQ7XHJcbiAgaWYgKCFjdXIpIHRocm93IG5ldyBFcnJvcihcIlJlcXVlc3Qgbm90IGZvdW5kXCIpO1xyXG5cclxuICBjb25zdCBuZXh0OiBSZWNvcmQ8TmVlZFN0YXR1cywgTmVlZFN0YXR1cz4gPSB7XHJcbiAgICBkcmFmdDogXCJzdWJtaXR0ZWRcIixcclxuICAgIHN1Ym1pdHRlZDogXCJtYW5hZ2VyX2FwcHJvdmVkXCIsXHJcbiAgICBtYW5hZ2VyX2FwcHJvdmVkOiBcImFkbWluX2FwcHJvdmVkXCIsXHJcbiAgICBhZG1pbl9hcHByb3ZlZDogXCJmaW5hbmNlX2FwcHJvdmVkXCIsXHJcbiAgICBmaW5hbmNlX2FwcHJvdmVkOiBcImZ1bGZpbGxlZFwiLFxyXG4gICAgcmVqZWN0ZWQ6IFwicmVqZWN0ZWRcIixcclxuICAgIGZ1bGZpbGxlZDogXCJmdWxmaWxsZWRcIixcclxuICB9O1xyXG4gIGNvbnN0IHRvID0gbmV4dFtjdXIuc3RhdHVzXTtcclxuICBpZiAoIXRvIHx8ICFjYW5UcmFuc2l0aW9uKGN1ci5zdGF0dXMsIHRvLCByb2xlKSkgdGhyb3cgbmV3IEVycm9yKFwiVHJhbnNpdGlvbiBub24gYXV0b3Jpc8OpZVwiKTtcclxuXHJcbiAgY29uc3QgcmVjOiBBcHByb3ZhbFJlY29yZCA9IHtcclxuICAgIHJvbGUsXHJcbiAgICBkZWNpc2lvbjogdG8gPT09IFwicmVqZWN0ZWRcIiA/IFwicmVqZWN0ZWRcIiA6IFwiYXBwcm92ZWRcIixcclxuICAgIGNvbW1lbnQsXHJcbiAgICBhdDogbm93SVNPKCksICAgICAgICAgICAgICAvLyBJU08gc3RyaW5nIChwYXMgc2VydmVyVGltZXN0YW1wKVxyXG4gICAgYnk6IG1lKCksXHJcbiAgfTtcclxuXHJcbiAgYXdhaXQgdXBkYXRlRG9jKHJlZiwge1xyXG4gICAgc3RhdHVzOiB0byxcclxuICAgIGxhc3RFdmVudEF0OiBzZXJ2ZXJUaW1lc3RhbXAoKSwgLy8gdG9wLWxldmVsIE9LXHJcbiAgICBhcHByb3ZhbHM6IChjdXIuYXBwcm92YWxzIHx8IFtdKS5jb25jYXQoW3JlY10pLFxyXG4gICAgaGlzdG9yeTogKGN1ci5oaXN0b3J5IHx8IFtdKS5jb25jYXQoW1xyXG4gICAgICB7IHR5cGU6IGBhcHByb3ZlZF8ke3JvbGV9YCwgYXQ6IG5vd0lTTygpLCBieTogbWUoKSwgZGF0YTogeyBjb21tZW50IH0gfSxcclxuICAgIF0pLFxyXG4gIH0pO1xyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gcmVqZWN0UmVxdWVzdChpZDogc3RyaW5nLCByb2xlOiBOZWVkUm9sZSwgY29tbWVudD86IHN0cmluZykge1xyXG4gIGNvbnN0IGRiID0gZ2V0RmlyZXN0b3JlKCk7XHJcbiAgY29uc3QgcmVmID0gZG9jKGRiLCBcIm5lZWRSZXF1ZXN0c1wiLCBpZCk7XHJcbiAgY29uc3Qgc25hcCA9IGF3YWl0IGdldERvYyhyZWYpO1xyXG4gIGNvbnN0IGN1ciA9IHNuYXAuZGF0YSgpIGFzIE5lZWRSZXF1ZXN0IHwgdW5kZWZpbmVkO1xyXG4gIGlmICghY3VyKSB0aHJvdyBuZXcgRXJyb3IoXCJSZXF1ZXN0IG5vdCBmb3VuZFwiKTtcclxuICBpZiAoIWNhblRyYW5zaXRpb24oY3VyLnN0YXR1cywgXCJyZWplY3RlZFwiLCByb2xlKSkgdGhyb3cgbmV3IEVycm9yKFwiVHJhbnNpdGlvbiBub24gYXV0b3Jpc8OpZVwiKTtcclxuXHJcbiAgY29uc3QgcmVjOiBBcHByb3ZhbFJlY29yZCA9IHtcclxuICAgIHJvbGUsXHJcbiAgICBkZWNpc2lvbjogXCJyZWplY3RlZFwiLFxyXG4gICAgY29tbWVudCxcclxuICAgIGF0OiBub3dJU08oKSxcclxuICAgIGJ5OiBtZSgpLFxyXG4gIH07XHJcblxyXG4gIGF3YWl0IHVwZGF0ZURvYyhyZWYsIHtcclxuICAgIHN0YXR1czogXCJyZWplY3RlZFwiLFxyXG4gICAgbGFzdEV2ZW50QXQ6IHNlcnZlclRpbWVzdGFtcCgpLFxyXG4gICAgYXBwcm92YWxzOiAoY3VyLmFwcHJvdmFscyB8fCBbXSkuY29uY2F0KFtyZWNdKSxcclxuICAgIGhpc3Rvcnk6IChjdXIuaGlzdG9yeSB8fCBbXSkuY29uY2F0KFtcclxuICAgICAgeyB0eXBlOiBgcmVqZWN0ZWRfJHtyb2xlfWAsIGF0OiBub3dJU08oKSwgYnk6IG1lKCksIGRhdGE6IHsgY29tbWVudCB9IH0sXHJcbiAgICBdKSxcclxuICB9KTtcclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGV4ZWN1dGVSZXF1ZXN0KGlkOiBzdHJpbmcsIGRldGFpbHM/OiB7IHBheW1lbnRSZWY/OiBzdHJpbmc7IG5vdGU/OiBzdHJpbmcgfSkge1xyXG4gIGNvbnN0IGRiID0gZ2V0RmlyZXN0b3JlKCk7XHJcbiAgY29uc3QgcmVmID0gZG9jKGRiLCBcIm5lZWRSZXF1ZXN0c1wiLCBpZCk7XHJcbiAgY29uc3Qgc25hcCA9IGF3YWl0IGdldERvYyhyZWYpO1xyXG4gIGNvbnN0IGN1ciA9IHNuYXAuZGF0YSgpIGFzIE5lZWRSZXF1ZXN0IHwgdW5kZWZpbmVkO1xyXG4gIGlmICghY3VyKSB0aHJvdyBuZXcgRXJyb3IoXCJSZXF1ZXN0IG5vdCBmb3VuZFwiKTtcclxuICAvLyBGaW5hbmNlIHBldXQgcGFzc2VyIGRlIGZpbmFuY2VfYXBwcm92ZWQgLT4gZnVsZmlsbGVkXHJcbiAgaWYgKGN1ci5zdGF0dXMgIT09IFwiZmluYW5jZV9hcHByb3ZlZFwiKSB0aHJvdyBuZXcgRXJyb3IoXCJOb24gZXjDqWN1dGFibGUgZGFucyBsJ8OpdGF0IGFjdHVlbFwiKTtcclxuXHJcbiAgYXdhaXQgdXBkYXRlRG9jKHJlZiwge1xyXG4gICAgc3RhdHVzOiBcImZ1bGZpbGxlZFwiLFxyXG4gICAgbGFzdEV2ZW50QXQ6IHNlcnZlclRpbWVzdGFtcCgpLFxyXG4gICAgaGlzdG9yeTogKGN1ci5oaXN0b3J5IHx8IFtdKS5jb25jYXQoW1xyXG4gICAgICB7IHR5cGU6IFwiZXhlY3V0ZWRcIiwgYXQ6IG5vd0lTTygpLCBieTogbWUoKSwgZGF0YTogZGV0YWlscyB8fCB7fSB9LFxyXG4gICAgXSksXHJcbiAgfSk7XHJcbn1cclxuXHJcbi8vIEFib25uZW1lbnRzIHRlbXBzIHLDqWVsIChVSSlcclxuZXhwb3J0IGZ1bmN0aW9uIHN1YnNjcmliZU15UmVxdWVzdHModWlkOiBzdHJpbmcsIGNiOiAoZG9jczogTmVlZFJlcXVlc3RbXSkgPT4gdm9pZCkge1xyXG4gIGNvbnN0IGRiID0gZ2V0RmlyZXN0b3JlKCk7XHJcbiAgY29uc3QgcSA9IHF1ZXJ5KFxyXG4gICAgY29sbGVjdGlvbihkYiwgXCJuZWVkUmVxdWVzdHNcIiksXHJcbiAgICB3aGVyZShcImNyZWF0ZWRCeS51aWRcIiwgXCI9PVwiLCB1aWQpLFxyXG4gICAgb3JkZXJCeShcImNyZWF0ZWRBdFwiLCBcImRlc2NcIiksXHJcbiAgKTtcclxuICByZXR1cm4gb25TbmFwc2hvdChxLCAoc25hcCkgPT4ge1xyXG4gICAgY2Ioc25hcC5kb2NzLm1hcCgoZCkgPT4gKHsgaWQ6IGQuaWQsIC4uLihkLmRhdGEoKSBhcyBhbnkpIH0pKSk7XHJcbiAgfSk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBzdWJzY3JpYmVRdWV1ZUZvclJvbGUocm9sZTogTmVlZFJvbGUsIGNiOiAoZG9jczogTmVlZFJlcXVlc3RbXSkgPT4gdm9pZCkge1xyXG4gIGNvbnN0IGRiID0gZ2V0RmlyZXN0b3JlKCk7XHJcbiAgbGV0IHFSZWY6IGFueTtcclxuICBpZiAocm9sZSA9PT0gXCJtYW5hZ2VyXCIpIHtcclxuICAgIHFSZWYgPSBxdWVyeShjb2xsZWN0aW9uKGRiLCBcIm5lZWRSZXF1ZXN0c1wiKSwgd2hlcmUoXCJzdGF0dXNcIiwgXCI9PVwiLCBcInN1Ym1pdHRlZFwiKSwgb3JkZXJCeShcImNyZWF0ZWRBdFwiLCBcImRlc2NcIikpO1xyXG4gIH0gZWxzZSBpZiAocm9sZSA9PT0gXCJhZG1pblwiKSB7XHJcbiAgICBxUmVmID0gcXVlcnkoY29sbGVjdGlvbihkYiwgXCJuZWVkUmVxdWVzdHNcIiksIHdoZXJlKFwic3RhdHVzXCIsIFwiPT1cIiwgXCJtYW5hZ2VyX2FwcHJvdmVkXCIpLCBvcmRlckJ5KFwiY3JlYXRlZEF0XCIsIFwiZGVzY1wiKSk7XHJcbiAgfSBlbHNlIGlmIChyb2xlID09PSBcImZpbmFuY2VcIikge1xyXG4gICAgcVJlZiA9IHF1ZXJ5KGNvbGxlY3Rpb24oZGIsIFwibmVlZFJlcXVlc3RzXCIpLCB3aGVyZShcInN0YXR1c1wiLCBcImluXCIsIFtcImFkbWluX2FwcHJvdmVkXCIsIFwiZmluYW5jZV9hcHByb3ZlZFwiXSksIG9yZGVyQnkoXCJjcmVhdGVkQXRcIiwgXCJkZXNjXCIpKTtcclxuICB9IGVsc2Uge1xyXG4gICAgcVJlZiA9IHF1ZXJ5KGNvbGxlY3Rpb24oZGIsIFwibmVlZFJlcXVlc3RzXCIpLCB3aGVyZShcInN0YXR1c1wiLCBcIj09XCIsIFwic3VibWl0dGVkXCIpLCBvcmRlckJ5KFwiY3JlYXRlZEF0XCIsIFwiZGVzY1wiKSk7XHJcbiAgfVxyXG4gIHJldHVybiBvblNuYXBzaG90KHFSZWYsIChzbmFwKSA9PiB7XHJcbiAgICBjYihzbmFwLmRvY3MubWFwKChkKSA9PiAoeyBpZDogZC5pZCwgLi4uKGQuZGF0YSgpIGFzIGFueSkgfSkpKTtcclxuICB9KTtcclxufSJdLCJuYW1lcyI6WyJnZXRGaXJlc3RvcmUiLCJzZXJ2ZXJUaW1lc3RhbXAiLCJjb2xsZWN0aW9uIiwiYWRkRG9jIiwiZG9jIiwidXBkYXRlRG9jIiwiZ2V0RG9jIiwib25TbmFwc2hvdCIsInF1ZXJ5Iiwid2hlcmUiLCJvcmRlckJ5IiwiYXV0aCIsIm5vd0lTTyIsIkRhdGUiLCJ0b0lTT1N0cmluZyIsIm1lIiwidSIsImN1cnJlbnRVc2VyIiwidWlkIiwiZW1haWwiLCJuYW1lIiwiZGlzcGxheU5hbWUiLCJzcGxpdCIsImNhblRyYW5zaXRpb24iLCJmcm9tIiwidG8iLCJyb2xlIiwiYWxsb3dlZCIsImRyYWZ0IiwiYnkiLCJzdWJtaXR0ZWQiLCJtYW5hZ2VyX2FwcHJvdmVkIiwiYWRtaW5fYXBwcm92ZWQiLCJmaW5hbmNlX2FwcHJvdmVkIiwicmVqZWN0ZWQiLCJmdWxmaWxsZWQiLCJzb21lIiwiciIsImNyZWF0ZU5lZWRSZXF1ZXN0IiwiaW5wdXQiLCJkYiIsInJlZiIsInRpdGxlIiwiZGVzY3JpcHRpb24iLCJhbW91bnQiLCJjdXJyZW5jeSIsImp1c3RpZmljYXRpb24iLCJhdHRhY2htZW50cyIsImNyZWF0ZWRCeSIsImNyZWF0ZWRBdCIsImxhc3RFdmVudEF0Iiwic3RhdHVzIiwiYXBwcm92YWxzIiwiaGlzdG9yeSIsInR5cGUiLCJhdCIsImRhdGEiLCJpZCIsInN1Ym1pdE5lZWRSZXF1ZXN0IiwiY3VyIiwiRXJyb3IiLCJjb25jYXQiLCJhcHByb3ZlUmVxdWVzdCIsImNvbW1lbnQiLCJzbmFwIiwibmV4dCIsInJlYyIsImRlY2lzaW9uIiwicmVqZWN0UmVxdWVzdCIsImV4ZWN1dGVSZXF1ZXN0IiwiZGV0YWlscyIsInN1YnNjcmliZU15UmVxdWVzdHMiLCJjYiIsInEiLCJkb2NzIiwibWFwIiwiZCIsInN1YnNjcmliZVF1ZXVlRm9yUm9sZSIsInFSZWYiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(app-pages-browser)/./src/lib/needs/firestore.ts\n"));

/***/ })

});